# AutoDL GPU 自动抢机 Chrome 插件

> 作者：王昭

自动监控 AutoDL 网站的 GPU 状态，当检测到可用实例时自动开机。

## 功能特性

- ✅ 自动监控 GPU 实例状态
- ✅ 检测到可用实例自动开机
- ✅ 支持无卡模式自动关机重启
- ✅ 浏览器通知提醒
- ✅ 可配置检查间隔
- ✅ 使用已登录的浏览器会话

## 安装步骤

### 1. 加载插件到 Chrome

1. 打开 Chrome 浏览器
2. 访问 `chrome://extensions/`
3. 打开右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择 `chrome-extension` 文件夹
6. 插件安装完成！

### 2. 准备图标（可选）

插件需要三个尺寸的图标：
- `icon16.png` (16x16)
- `icon48.png` (48x48)
- `icon128.png` (128x128)

你可以：
- 使用任何 PNG 图片并重命名
- 或者我可以帮你创建简单的图标

## 使用方法

### 1. 登录 AutoDL

在浏览器中登录 https://www.autodl.com

### 2. 打开实例列表页面

访问：https://www.autodl.com/console/instance/list

### 3. 配置插件

1. 点击浏览器工具栏中的插件图标
2. 设置目标实例名称（如 "西北B区 / 007机"）
3. 选择检查间隔（建议 5-10 秒）
4. 点击"开始监控"

### 4. 保持页面打开

- 插件会在后台自动监控
- 不需要保持标签页激活
- 但需要保持浏览器运行

## 工作原理

### 监控逻辑

```
每隔 N 秒：
  1. 检查目标实例的状态
  2. 获取 GPU 空闲信息（通过悬停）
  3. 判断是否需要操作：
  
  情况 1: 无卡模式运行 + GPU 可用
    → 关机 → 等待 → 开机（带GPU）
  
  情况 2: 已关机 + GPU 可用
    → 直接开机
  
  情况 3/4: GPU 不可用
    → 继续等待
```

### 通知提醒

- 检测到 GPU 可用时：发送通知
- 开机成功后：发送成功通知
- 自动停止监控

## 优势对比

### vs Python 脚本

| 特性 | Chrome 插件 | Python 脚本 |
|------|------------|------------|
| 安装依赖 | ✅ 无需安装 | ❌ 需要 Playwright |
| 登录状态 | ✅ 使用已登录浏览器 | ❌ 需要重新登录 |
| 资源占用 | ✅ 轻量 | ❌ 需要额外浏览器实例 |
| 后台运行 | ✅ 支持 | ✅ 支持 |
| 跨平台 | ✅ 所有平台 | ✅ 所有平台 |
| 配置界面 | ✅ 图形界面 | ❌ 需要修改代码 |

## 注意事项

1. **保持浏览器运行**：插件需要浏览器保持打开状态
2. **检查间隔**：建议设置为 5-10 秒，避免过于频繁
3. **网络稳定**：确保网络连接稳定
4. **实例名称**：必须准确匹配实例名称
5. **浏览器通知**：首次使用时需要允许通知权限

## 故障排除

### 问题：插件无法加载

- 确认已开启"开发者模式"
- 检查 manifest.json 是否存在语法错误

### 问题：监控不工作

- 确认已打开 AutoDL 实例列表页面
- 检查实例名称是否正确
- 打开浏览器控制台查看错误信息

### 问题：无法点击按钮

- 刷新页面重试
- 检查页面结构是否变化

## 开发说明

### 文件结构

```
chrome-extension/
├── manifest.json       # 插件配置文件
├── background.js       # 后台服务脚本
├── content.js         # 页面内容脚本
├── popup.html         # 弹窗界面
├── popup.js           # 弹窗逻辑
├── icon16.png         # 16x16 图标
├── icon48.png         # 48x48 图标
├── icon128.png        # 128x128 图标
└── README.md          # 说明文档
```

### 调试方法

1. **查看后台日志**：
   - 访问 `chrome://extensions/`
   - 点击插件的"service worker"
   - 查看控制台输出

2. **查看内容脚本日志**：
   - 打开 AutoDL 页面
   - 按 F12 打开开发者工具
   - 查看控制台输出

## 许可证

MIT License
